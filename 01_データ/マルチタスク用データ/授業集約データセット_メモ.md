# 授業集約データセット メモ

## 📅 作成日時
2025年10月12日 14:25:04

## 📊 データセット概要

### 基本情報
- **ファイル名**: `授業集約データセット_20251012_142504.csv`
- **授業数**: 3,268授業
- **データソース**: `感情分類結果_前処理データ結合_20250729_154855.csv`
- **作成スクリプト**: `00_スクリプト/create_course_aggregated_dataset.py`

### データ構造
| カラム名 | 説明 | 例 |
|---------|------|-----|
| 開講年度 | 授業の開講年度・学期 | "2019年　前期　～　2019年　前期" |
| 授業ID | 授業の識別子 | "1010101　現代倫理" |
| 授業キー | 開講年度_授業IDの組み合わせ | "2019年　前期　～　2019年　前期_1010101　現代倫理" |
| 自由記述まとめ | 授業の全自由記述を結合 | "人間としての在り方生き方を..." |
| 自由記述数 | 集約した記述の数 | 47 |
| 感情スコア平均 | 感情スコアの平均値 | 0.106 |
| ネガティブ比率 | ネガティブの割合 | 0.40 |
| ニュートラル比率 | ニュートラルの割合 | 0.09 |
| ポジティブ比率 | ポジティブの割合 | 0.51 |
| 授業評価スコア | 授業の評価スコア | 3.36 |

## 📈 統計情報

### 自由記述数
- **平均**: 25.2件/授業
- **標準偏差**: 22.9
- **最小**: 5件
- **最大**: 239件
- **中央値**: 18件

### 感情スコア平均
- **平均**: 0.001（ほぼニュートラル）
- **標準偏差**: 0.260
- **範囲**: -1.0 ～ 1.0
- **中央値**: 0.0

### 授業評価スコア
- **平均**: 3.46点
- **標準偏差**: 0.22
- **範囲**: 2.0 ～ 4.0点
- **中央値**: 3.48点

### 相関分析
- **感情スコアと授業評価スコアの相関係数**: 0.310（中程度の正の相関）

## 🎯 データセットの特徴

### 改善点
1. **構造的整合性**: 授業の全自由記述 → 授業の評価スコア（論理的に一致）
2. **豊富な情報**: 全自由記述を上限なく結合
3. **正確な識別**: 開講年度と授業IDを組み合わせて一意に識別
4. **感情分析**: tuned_model_labelを使用した正確な感情スコア

### 前回の問題解決
- **個人→集団平均の不一致**: 解決済み
- **R²=0.016の低性能**: 改善が期待される
- **データの偏り**: より多様な意見を反映

## 🚀 次のステップ

### 1. マルチタスク学習モデル構築
- **入力**: 自由記述まとめ（授業の全自由記述）
- **出力1**: 感情スコア平均（回帰タスク）
- **出力2**: 授業評価スコア（回帰タスク）

### 2. 期待される改善
- **R²の向上**: 0.016 → 0.3-0.6（期待）
- **相関の向上**: 0.310 → より高い相関
- **実用的な予測**: 授業改善の示唆

### 3. SHAP分析
- 授業レベルの重要語抽出
- 感情スコアと評価スコアの関係性分析
- 授業改善の具体的指針

## 📝 使用例

```python
import pandas as pd

# データセット読み込み
df = pd.read_csv('授業集約データセット_20251012_142504.csv')

# 基本統計
print(f"授業数: {len(df)}")
print(f"平均自由記述数: {df['自由記述数'].mean():.1f}")
print(f"感情スコアと評価スコアの相関: {df['感情スコア平均'].corr(df['授業評価スコア']):.3f}")

# サンプル表示
print("\nサンプル授業:")
for i, row in df.head(3).iterrows():
    print(f"{row['開講年度']} - {row['授業ID']}")
    print(f"  自由記述数: {row['自由記述数']}")
    print(f"  感情スコア平均: {row['感情スコア平均']:.3f}")
    print(f"  授業評価スコア: {row['授業評価スコア']}")
```

## 🔧 技術詳細

### データ処理
- **最小記述数**: 5件以上（フィルタリング）
- **最大記述数**: 制限なし（全記述結合）
- **感情スコア**: tuned_model_labelを使用
- **授業識別**: 開講年度_授業IDの組み合わせ

### 品質管理
- **データ整合性**: 授業評価スコアの抽出確認
- **欠損値処理**: NaN値の適切な処理
- **エラーハンドリング**: ファイル読み込みエラーの処理

---

**作成者**: [あなたの名前]  
**最終更新**: 2025年10月12日  
**バージョン**: 1.0
