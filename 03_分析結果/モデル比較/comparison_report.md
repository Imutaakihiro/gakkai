# モデル性能比較レポート

**作成日時**: 2025年10月11日 19:35:13

## 1. 概要

本レポートでは、以下の3つのモデルの性能を比較する。

1. **単一タスクモデル1**: 自由記述 → 感情スコア（分類タスク）
2. **単一タスクモデル2**: 自由記述 → 評価スコア（回帰タスク）
3. **マルチタスクモデル**: 自由記述 → 感情スコア + 評価スコア

すべてのモデルは `koheiduck/bert-japanese-finetuned-sentiment` をベースとしている。

## 2. 感情分析性能の比較


| 指標 | 単一タスクモデル1 | マルチタスクモデル | 差分 |
|------|------------------|-------------------|------|
| Accuracy | 0.7700 | 0.7250 | -0.0450 |
| F1-Score (Macro) | 0.7061 | 0.6552 | -0.0508 |
| F1-Score (Weighted) | 0.7699 | 0.7190 | -0.0508 |
| Precision | 0.7072 | 0.6916 | -0.0156 |
| Recall | 0.7052 | 0.6323 | -0.0729 |

![感情分析性能の比較](sentiment_comparison.png)


## 3. 評価スコア予測性能の比較


| 指標 | 単一タスクモデル2 | マルチタスクモデル | 差分 |
|------|------------------|-------------------|------|
| RMSE | 0.1972 | 0.1928 | -0.0044 |
| MAE | 0.1563 | 0.1480 | -0.0083 |
| R² | 0.0157 | -0.1081 | -0.1238 |
| 相関係数 | 0.1904 | 0.0940 | -0.0964 |

![評価スコア予測性能の比較](score_comparison.png)


## 4. 考察

### 4.1 感情分析における性能差

#### 4.1.1 単一タスクモデルの優位性

単一タスクモデル1は**Accuracy 77.0%**を達成し、マルチタスクモデル（72.5%）を**4.5ポイント上回った**。

**原因分析:**

1. **タスク特化の利点**
   - 単一タスクモデルは感情分析のみに最適化されている
   - すべてのモデルパラメータが1つの目的に集中
   - 損失関数も感情分類のみを考慮

2. **マルチタスクのトレードオフ**
   - マルチタスクモデルは2つのタスク間で表現を共有
   - 評価スコア予測タスク（困難なタスク）が感情分析の学習に干渉
   - 共有エンコーダが両タスクの妥協点を探すため、個別最適には至らない

3. **Recallの大幅低下（-7.3%）**
   - 特にRecallが0.705→0.632と大きく低下
   - これは、マルチタスク学習により、一部のクラス（特にMinorityクラス）の識別能力が低下したことを示唆

#### 4.1.2 実用上の示唆

感情分析を主目的とする場合、**単一タスクモデル1を推奨**する。
- より高い精度（77%）
- シンプルな運用
- タスク特化の安定性

---

### 4.2 評価スコア予測における困難性

#### 4.2.1 両モデルの予測困難性

**重要な発見:**
```
単一タスクモデル2: R² = 0.016
マルチタスクモデル:  R² = -0.108
```

**両モデルともR²≈0（またはマイナス）**であり、評価スコアの予測は極めて困難である。

#### 4.2.2 データ構造の本質的問題

この困難性の主な原因は、**データ構造の不一致**にある：

```
入力: 個人の自由記述（1人の主観的意見）
出力: 授業評価スコア（複数学生の平均値）
```

**具体例:**
- 「過去問は当てにならない」（ネガティブな個人の意見）
- → 授業評価スコア: 3.55点（他の学生は高評価）

個人の意見が必ずしも集団の傾向を反映しないため、1人の記述から全体の平均を予測することは**理論的に限界**がある。

#### 4.2.3 マルチタスクによるRMSE/MAEの改善

興味深いことに、マルチタスクモデルは：
- **RMSE**: 0.197 → 0.193（2.2%改善）
- **MAE**: 0.156 → 0.148（5.3%改善）

誤差の絶対値は若干改善している。これは、感情情報がスコア予測に部分的に寄与していることを示唆する。

#### 4.2.4 R²と相関係数の悪化

しかし、**R²と相関係数は悪化**：
- **R²**: 0.016 → -0.108（12.4%悪化）
- **相関**: 0.190 → 0.094（9.6%悪化）

**解釈:**
- R²がマイナスということは、「平均値を予測するより悪い」ことを意味する
- 感情タスクとの共有学習により、予測のバイアスが増加した可能性
- 個々の誤差（MAE）は小さくなるが、予測の方向性（相関）が失われている

---

### 4.3 マルチタスク学習の効果と限界

#### 4.3.1 タスク間の相互作用

本実験により、以下のタスク間相互作用が観察された：

```
感情分析タスク:
単一 77.0% → マルチ 72.5% (−4.5%)
→ 評価スコアタスクが負の影響

評価スコアタスク:
両方とも困難（R²≈0）
→ RMSE/MAEは改善、R²は悪化
```

**考察:**
- 感情（分類）と評価スコア（回帰）という異なるタスク特性が干渉
- 共有表現が両タスクの最適解の妥協点となり、個別性能が低下
- 特に、困難なタスク（評価スコア予測）が容易なタスク（感情分析）の足を引っ張る

#### 4.3.2 損失関数の重みの影響

本実験では、`ALPHA=0.5, BETA=0.5`と均等な重みを設定した。

**今後の改善案:**
- 感情分析を重視する場合: `ALPHA=0.7, BETA=0.3`
- 評価スコアを重視する場合: `ALPHA=0.3, BETA=0.7`
- 動的な重み調整（Uncertainty Weightingなど）

---

### 4.4 マルチタスク学習のメリット・デメリット（まとめ）

#### メリット

- ✅ **効率性**: 2つのタスクを1つのモデルで実行可能（推論効率の向上）
- ✅ **汎化性能**: 共有表現を学習することで汎化性能が向上する可能性
- ✅ **運用性**: モデルの管理・デプロイが容易
- ✅ **部分的改善**: 評価スコアのRMSE/MAEは若干改善

#### デメリット（本実験で観察）

- ⚠️ **精度のトレードオフ**: 感情分析で4.5%の精度低下
- ⚠️ **タスク間干渉**: 困難なタスクが容易なタスクに負の影響
- ⚠️ **調整の複雑さ**: タスク間のバランス調整が必要（損失関数の重み）
- ⚠️ **訓練の複雑化**: 訓練プロセスが複雑になる

---

### 4.5 実用上の推奨

#### 4.5.1 用途別の推奨モデル

**感情分析が主目的の場合:**
- → **単一タスクモデル1を推奨**（Accuracy 77%）
- 理由: より高い精度、シンプルな運用

**2つのタスクを同時実行したい場合:**
- → **マルチタスクモデル**
- 理由: 推論効率、ただし精度トレードオフを許容

**評価スコア予測のみの場合:**
- → **どちらも推奨しない**（R²≈0）
- 理由: データ構造の問題により予測困難
- 代替案: データ収集方法の変更（複数記述→平均値）

#### 4.5.2 授業評価への応用

本実験の結果、**感情分析（単一タスクモデル1）**が最も実用的価値が高いと結論づけられる。

**応用例:**
1. 自由記述の自動分類（ポジティブ/ニュートラル/ネガティブ）
2. ネガティブ意見の早期検出と対応
3. 授業改善のための定性的フィードバック収集

次フェーズのSHAP分析により、**どの要素が学生満足度に寄与するか**を特定し、教員への具体的な改善提案を行う。

---

### 4.6 研究の学術的貢献

#### 4.6.1 理論的貢献

1. **個人→集団平均予測の限界を実証**
   - R²≈0という結果は、このタスクの本質的困難性を示す
   - 今後の研究への警告・ガイダンス

2. **マルチタスク学習のタスク間干渉を観察**
   - 困難なタスクが容易なタスクに負の影響
   - タスク選択の重要性を示唆

#### 4.6.2 方法論的貢献

1. **日本語授業評価データでの系統的比較**
   - 単一タスク vs マルチタスクの定量的比較
   - 再現可能な実験プロトコルの確立

2. **評価指標の多角的検証**
   - 分類タスク: Accuracy, F1, Precision, Recall
   - 回帰タスク: RMSE, MAE, R², 相関係数
   - 両タスクを統一的に評価

#### 4.6.3 実用的貢献（今後のSHAP分析で）

- 学生満足度に寄与する要因の特定
- 教育現場へのフィードバック
- 授業改善への具体的提言

---

### 4.7 結論

本実験により、以下が明らかになった：

1. **感情分析では単一タスク学習が優位**（77% vs 72.5%）
   - マルチタスク学習による精度低下が観察された
   - 実用上は単一タスクモデル1を推奨

2. **評価スコア予測は両モデルとも困難**（R²≈0）
   - データ構造の問題（個人→集団平均）に起因
   - マルチタスク学習でもこの限界は克服できない
   - ただし、RMSE/MAEは若干改善（2-5%）

3. **マルチタスク学習のトレードオフを実証**
   - 効率性の利点がある一方、精度のトレードオフが存在
   - タスクの選択と重み調整が重要

4. **今後の方向性**
   - 感情分析に注力（Accuracy 77%の実用性）
   - SHAP分析で解釈可能性を高める
   - 評価スコア予測はデータ収集方法の改善が必要

## 5. 今後の展望

- SHAP分析による解釈可能性の検証
- モデル間の予測の違いを詳細に分析
- ハイパーパラメータの最適化（特にマルチタスクの損失重み）
- より大きなデータセットでの検証
