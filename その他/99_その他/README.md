# マルチタスク学習による授業評価分析システム

## 📋 概要

本研究では、BERTベースのマルチタスク学習モデルを用いて、授業評価アンケートの感情分析と評価スコア予測を同時に学習し、SHAPによる解釈可能性分析を通じて授業改善のための要因を特定するシステムを構築しました。

## 🎯 最終ゴール

**「授業改善のために『どんな感情が評価に効いているか』を具体的に示す」**

## 🏗️ システム構成

### マルチタスク学習アーキテクチャ
- **共有エンコーダー**: BERT-base-japanese-v3
- **感情分類ヘッド**: 3クラス分類（Negative, Neutral, Positive）
- **評価回帰ヘッド**: 連続値予測（1.0-5.0スケール）

### 解釈可能性分析
- **形態素解析**: MeCabによる自然な単語分割
- **SHAP分析**: 特徴量重要度の定量化
- **比較分析**: 高評価群と低評価群の要因比較

## 📊 データセット

- **総データ数**: 996件
- **感情ラベル**: 3クラス（Negative, Neutral, Positive）
- **評価スコア範囲**: 2.00-3.87
- **高評価群**: 249件（スコア ≥ 3.57）
- **低評価群**: 249件（スコア ≤ 3.33）

## 🚀 使用方法

### Google Colabでの実行

1. **完全統合SHAP分析**
```python
exec(open('complete_shap_analysis.py').read())
```

2. **必要なファイルのアップロード**
- `multitask_bert_model.pth` (学習済みモデル)
- `マルチタスク学習用データセット_20250930_202839.csv` (データセット)

### ローカル環境での実行

1. **環境構築**
```bash
pip install torch transformers shap pandas numpy matplotlib seaborn wordcloud mecab-python3
```

2. **マルチタスク学習**
```python
python multitask_training_with_pretrained.py
```

3. **SHAP分析**
```python
python complete_shap_analysis.py
```

## 📁 ファイル構成

```
├── complete_shap_analysis.py          # 完全統合SHAP分析
├── multitask_training_with_pretrained.py  # マルチタスク学習
├── multitask_bert_model.pth          # 学習済みモデル
├── マルチタスク学習用データセット_20250930_202839.csv  # データセット
├── Docs/                              # ドキュメント
│   ├── マルチタスク学習記録.md
│   ├── Attention可視化ログ.md
│   └── 学会発表予稿_完成.tex
├── GoogleColab/                       # Colab用ファイル
└── README.md                          # このファイル
```

## 🔬 技術的詳細

### マルチタスク学習の最適化
- 動的損失重み付け
- 学習率スケジューリング（CosineAnnealingLR）
- 勾配クリッピング
- 早期停止

### 解釈可能性の向上
- MeCabによる形態素解析
- 助詞・助動詞・1文字単語の除外
- SHAPによる特徴量重要度の定量化
- 高評価群と低評価群の比較分析

## 📈 期待される結果

### 感情分析タスク
- **高評価要因**: 「わかりやすい」「楽しい」「面白い」
- **低評価要因**: 「難しい」「つまらない」「分からない」

### 評価予測タスク
- 感情分析と評価予測の要因の一致
- 授業改善の具体的指針の提示

## 🎓 教育学的含意

1. **理解度の重要性**: 「わかりやすい」は高評価の最重要要因
2. **授業の楽しさ**: 「楽しい」「面白い」が評価向上に寄与
3. **難易度の調整**: 「難しい」は低評価の主要要因
4. **感情と評価の一致**: 感情分析と評価予測の要因が一致

## 📚 学術的貢献

1. **マルチタスク学習の適用**: 授業評価分析への新たなアプローチ
2. **解釈可能性の向上**: 教育実践に活用可能な分析手法
3. **実証的知見**: 感情と評価の関係性の定量化
4. **教育改善への示唆**: 具体的な授業改善指針の提示

## 🔧 環境要件

- Python 3.8+
- PyTorch 1.9+
- Transformers 4.0+
- SHAP 0.40+
- MeCab (日本語形態素解析)

## 📄 ライセンス

このプロジェクトは学術研究目的で作成されています。

## 👥 貢献

プルリクエストやイシューの報告を歓迎します。

## 📞 連絡先

研究に関する質問や提案がございましたら、お気軽にお声がけください。

