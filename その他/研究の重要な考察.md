# 研究の重要な考察と発見

## 📅 記録日: 2025年10月10日

---

## 🔍 重要な発見: 評価スコア予測の本質的困難性

### 1. 問題の構造

本研究では、個人の自由記述から授業全体の評価スコア（平均値）を予測することを試みた。

しかし、このタスクは**本質的に困難**である：

#### データの不一致

```
【自由記述】
"先生の説明がわかりやすかった"
↓ これは...
1人の学生Aさんの意見

【授業評価スコア】
3.45点
↓ これは...
その授業を受けた100人の平均
```

**1人の意見 → 100人の平均** を予測しようとしている問題

---

### 2. 具体的な例

#### データから見る不一致の実例

```csv
ID,自由記述,感情スコア,授業評価スコア
40455,"過去問は当てにならない。",-1.0,3.55
66659,"小テストが予定日通りに進まない",-1.0,3.31
3720,"自分は受ける日にむらがあって時間割通りに授業を受けることができなかった",-1.0,3.42
```

**観察:**
- ネガティブな個人の意見（感情スコア: -1.0）
- しかし授業評価スコアは普通〜高い（3.31〜3.55）

**理由:**
- その学生個人はネガティブに感じている
- しかし**他の多くの学生**は肯定的に評価している
- 結果として**全体の平均**は高くなる

→ **個人の意見と集団の平均は一致しない**

---

### 3. 実験結果

#### 単一タスクモデル2（評価スコア予測）の性能

**訓練日時:** 2025年10月10日 19:14:08

**データセット:**
- 訓練データ: 797件
- 検証データ: 200件

**最終性能指標:**
- **RMSE: 0.197** (正規化後)
- **MAE: 0.156**
- **R²: 0.016** ← 非常に低い！
- **相関係数: 0.190** ← 弱い相関

**訓練履歴:**
```
Epoch 1: Val RMSE 1.013
Epoch 2: Val RMSE 1.002 ⭐ベスト
Epoch 3: Val RMSE 1.035
Epoch 4: Val RMSE 1.010
Epoch 5: Val RMSE 1.015
```

---

### 4. R²が低い理由の分析

#### R²とは何か
- R² = 1: 完璧な予測
- R² = 0: 平均値を予測するのと同じ
- **R² = 0.016**: ほぼ予測できていない

#### なぜこうなるか

1. **構造的な問題**
   - 個人の意見（X）と集団の平均（Y）には本質的な乖離がある
   - 同じテキストでも、他の学生の評価次第でYは変わる

2. **情報の欠如**
   - モデルが見ているのは「1人の意見」だけ
   - 必要なのは「全員の意見」

3. **予測の限界**
   - 1人の意見から100人の意見を推測することは不可能

---

### 5. 卒論での書き方（案）

#### 5章 考察

##### 5.1 評価スコア予測の困難性

```
単一タスクモデル2では、自由記述から授業評価スコアを
予測するタスクにおいて、R²が0.016と非常に低い結果となった。

この主な原因は、データの構造的な不一致にあると考えられる。
具体的には：

1. 自由記述は個人の主観的意見を表す
2. 授業評価スコアは複数の学生の平均値である
3. 個人の意見が必ずしも全体の傾向を反映しない

例えば、データID 40455の学生は「過去問は当てにならない」と
ネガティブな意見を述べているが、その授業全体の評価スコアは
3.55点と比較的高い。これは、他の多くの学生が肯定的に評価して
いるためである。

このような構造的な問題により、個人の自由記述から集団の平均値を
予測することは本質的に困難であることが明らかになった。
```

##### 5.2 マルチタスク学習による改善の可能性

```
それでも、感情分析タスクとの同時学習により、共有表現が学習
されることで、わずかながら改善が見られる可能性がある。

マルチタスクモデルの結果を確認し、以下を検証する：
1. 感情情報が評価スコア予測に寄与するか
2. 共有表現学習の効果はあるか
3. タスク間の相互作用はどの程度か

（結果は次セクションで述べる）
```

---

## 💡 改善案（将来の研究への提案）

### 案1: データ構造の変更

**現在の問題:**
```
入力: 1人の自由記述
出力: 集団の平均評価スコア
```

**改善後:**
```
入力: 複数人の自由記述（10件以上）
出力: 集団の平均評価スコア
```

**実装方法:**
- 同じ授業IDの自由記述を集約
- BERTで各記述を埋め込みベクトル化
- 平均プーリングして集団表現を作成
- この集団表現から評価スコアを予測

**期待される効果:**
- 集団の意見 → 集団の評価（整合性あり）
- R²の大幅な向上が期待できる

---

### 案2: タスクの再定義

**元のタスク:**
```
自由記述 → 授業評価スコア（回帰, 1-5点）
```

**新しいタスク:**
```
自由記述 → この学生の満足度（分類, 高/低）
```

**メリット:**
- 個人の意見 → 個人の評価（整合性あり）
- 分類タスクの方が安定
- 実用性: 個々の学生の満足度を把握できる

---

### 案3: 感情分析に特化

**判断:**
評価スコア予測は諦め、感情分析に注力する

**理由:**
- 感情分析の精度は**77%**と実用レベル
- タスクの整合性が高い（個人の意見 → 個人の感情）
- 実用性が高い（自由記述の自動分類）

**研究の方向性:**
- 感情分析の精度向上に集中
- SHAP分析で解釈可能性を高める
- 授業改善への応用を提案

---

## ✅ 研究の意義（それでもやる価値がある理由）

### 1. マルチタスク学習の効果検証

- 評価スコア予測単独では困難
- しかし感情分析との同時学習で改善する可能性
- **マルチタスク学習の有効性を実証的に検証**

### 2. 方法論の確立

- 将来、適切なデータ（集団の記述）があれば使える手法
- 研究の再現性を確保
- 他の研究者への貢献

### 3. 限界の明確化

- **何が可能で何が不可能か**を示す
- 失敗から学ぶ（Negative Result）も重要な研究成果
- 卒論での誠実な議論は高く評価される

### 4. 感情分析の有用性

- Accuracy 77%は十分実用的
- 授業アンケートの自動分析に活用可能
- 教育現場での実用性を示す

---

## 📊 次のステップ

### 即時（マルチタスクモデル訓練完了後）

1. ✅ マルチタスクモデルの結果を確認
2. ✅ 単一タスクとの比較分析
3. ✅ 感情分析と評価スコア予測の相互作用を検証

### 短期（1-2週間）

1. ✅ SHAP分析の実装
   - 重要な単語・フレーズの特定
   - モデルの判断根拠の可視化
   - 検証データ200件 + サンプリング5,000件（層化）で実施完了

2. 詳細な誤差分析
   - どのような記述で失敗するか
   - 感情スコアとの関係は？

3. **🎯 最重要課題: モデル精度の向上（BERTチューニング）**
   - **現状**: 感情分析 Accuracy 77%
   - **目標**: Accuracy 80-85%以上
   - **方法**:
     - ハイパーパラメータチューニング
       - 学習率（現在5e-6）の最適化
       - エポック数の調整
       - バッチサイズの変更
       - Dropout率の最適化
     - データ拡張（Data Augmentation）
       - Back Translation（日→英→日）
       - 同義語置換
       - ノイズ付加
     - アーキテクチャ改善
       - 層別学習率（Layer-wise Learning Rate）
       - Warm-up Stepsの調整
       - Weight Decay の調整
     - アンサンブル学習
       - 複数モデルの予測を統合
     - ファインチューニング戦略
       - 段階的アンフリーズ（Gradual Unfreezing）
       - Discriminative Fine-tuning
   - **実装優先度**:
     1. ハイパーパラメータグリッドサーチ（最も効果的）
     2. データ拡張（比較的容易）
     3. アーキテクチャ改善（時間あれば）
   - **期待効果**: 精度向上により、SHAP分析の信頼性も向上し、卒論の説得力が増す

### 中期（卒論執筆時）

1. モデル精度向上の実験と検証
   - ハイパーパラメータチューニング実施
   - 複数設定での性能比較
   - 最適モデルでSHAP再分析

2. 考察の執筆
   - 本ドキュメントをベースに
   - 実験結果を統合
   - 改善案の提示
   - **精度向上の効果を定量的に記述**

3. 図表の作成
   - 散布図（予測値 vs 実測値）
   - 相関分析の可視化
   - 誤差分布の分析
   - **チューニング前後の精度比較表**

---

## 🎓 卒論での位置づけ

### この考察を活かす章構成

```
1. 序論
   - 研究背景・目的

2. 関連研究
   - マルチタスク学習
   - 感情分析

3. 提案手法
   - 3つのモデル構成

4. 実験
   4.1 データセット
   4.2 実験設定
   4.3 評価指標

5. 結果
   5.1 単一タスクモデル1（感情スコア）
   5.2 単一タスクモデル2（評価スコア）← ここで低いR²を報告
   5.3 マルチタスクモデル

6. 考察 ← **このドキュメントの内容を使う**
   6.1 評価スコア予測の困難性 ← ★重要
   6.2 マルチタスク学習の効果
   6.3 感情分析の有用性
   6.4 改善案の提案

7. 結論
   - 研究のまとめ
   - 今後の課題
```

---

## 📝 メモ・補足

### 統計的な補足

- **R² = 0.016**は「予測できない」ことを意味する
- しかしこれは「モデルが悪い」のではなく「タスクが不適切」
- ベースライン（平均値予測）とほぼ同じ性能

### 比較のための参考値

- 良いR²: 0.7以上
- 普通のR²: 0.4-0.7
- 低いR²: 0.2以下
- **本研究: 0.016（ほぼ0）**

### ポジティブな解釈

「失敗」ではなく「発見」：
- 個人の意見から集団の評価は予測できない（科学的な発見）
- この知見は教育工学・データサイエンスへの貢献
- 今後の研究者へのガイダンス

---

## 📚 参考文献（後で追加）

- マルチタスク学習の理論
- 教育データマイニングの先行研究
- 感情分析の応用研究

---

**最終更新: 2025年10月10日**
**作成者: [あなたの名前]**

---

## 🗣️ 会話サマリー: 研究方針の転換とSHAP実施計画（2025-10-10）

### 1) 当初の目標と期待
- **目標**: 自由記述から授業評価スコア（集団の平均）を予測し、スコアを押し上げる要因を特定する。
- **期待**: 「この単語が出るとスコアが上がる」といった具体的要因の抽出。

### 2) 実験結果と発見（重要）
- 単一タスク（評価スコア回帰）の結果は **R²=0.016、相関0.19** と低く、予測困難。
- 原因分析より、入力（個人の自由記述）と出力（集団平均）の構造的不一致を確認。
  - 個人のネガティブ記述でも、他多数のポジティブ評価で平均スコアは高くなる例が多数。
- 結論: 「個人→集団平均」の予測は本質的に困難であり、低いR²はモデルの失敗ではなくデータ構造の性質を反映。

### 3) 方針転換の妥当性（教授説明の要点）
- 当初仮説は、実データ分析により「構造的に達成困難」と判明（実証的発見）。
- より整合的で実用的なタスクへピボット:
  - 個人の自由記述 → 個人の感情（満足度近似）
  - 感情分析モデル（Accuracy≈0.77）に対しSHAPで重要語を可視化
- 期待される価値:
  - 理論的貢献: 個人→集団平均予測の限界を提示
  - 実用的貢献: 満足度を高める単語・要素の抽出（授業改善の示唆）

### 4) SHAP分析の対象と優先順位
- 🥇 単一タスクモデル1（感情分類）: 主対象。精度良好・解釈容易・実用価値大。
- 🥈 マルチタスクモデル（感情出力）: 単一との比較で注目単語の差分を検証。
- 🥉 単一タスクモデル2（評価回帰）: 失敗要因の可視化（個人語彙と集団平均の乖離の証拠）。

### 5) 成果物のイメージ
- 重要単語ランキング（ポジ/ネガ/ニュートラル別）
- 代表事例のSHAPテキスト可視化（force/text plot）
- 単一 vs マルチの注目単語比較図
- 回帰タスクにおける失敗事例の可視化（注目単語と実測スコアのギャップ）

### 6) 教授への説明テンプレ（要約）
> 当初の評価スコア予測は、個人→集団平均という構造的不一致のため実証的に困難（R²=0.016）。
> 発見自体が研究成果。今後は整合性のある「個人→個人」タスク（感情分析）に注力し、
> SHAPで満足度に寄与する語を可視化して、授業改善の具体的示唆を提示する計画です。

### 7) 次アクション（短期）
- マルチタスク学習の実行完了を待機 → 評価
- SHAP分析の実装開始（まずは単一タスク感情モデル）
- 可視化とレポート化（Doc/図表出力）

更新者: [あなたの名前]（2025-10-10）

