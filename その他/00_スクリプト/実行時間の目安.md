# マルチタスク学習の実行時間目安

## 📊 現在の設定

- **エポック数**: 3
- **バッチサイズ**: 2
- **データセット**: 約3,270件（授業集約データセット 回答分布付き.csv）
- **モデル**: BERT日本語（koheiduck/bert-japanese-finetuned-sentiment）
- **最大トークン長**: 192
- **チャンク数**: 最大4チャンク/サンプル

## ⏱️ 予想実行時間

### Windows (NVIDIA GPU / CUDA使用時)

| 環境 | 予想時間 | 備考 |
|------|---------|------|
| **RTX 3060 / 3070** | **30-45分** | 推奨環境 |
| **RTX 3080 / 3090** | **20-35分** | 高速 |
| **RTX 4060 / 4070** | **25-40分** | 良好 |
| **RTX 4090** | **15-25分** | 最速 |

### MacBook M4 (MPS使用時)

| 環境 | 予想時間 | 備考 |
|------|---------|------|
| **M4 (標準)** | **40-60分** | MPS対応 |
| **M4 Pro** | **30-50分** | より高速 |
| **M4 Max** | **25-45分** | 最速 |

### CPUのみ（GPUなし）

| 環境 | 予想時間 | 備考 |
|------|---------|------|
| **Intel Core i7/i9** | **2-4時間** | 非推奨 |
| **Apple M4 (CPU)** | **1.5-3時間** | 非推奨 |

## 📈 過去の実績との比較

### 以前の実行（2024年9月30日）

- **データ数**: 996件
- **バッチサイズ**: 8
- **エポック数**: 3
- **実行時間**: **約15分**（CPU使用）

### 現在の設定との違い

| 項目 | 以前 | 現在 | 倍率 |
|------|------|------|------|
| データ数 | 996件 | 3,270件 | **3.3倍** |
| バッチサイズ | 8 | 2 | **0.25倍** |
| エポック数 | 3 | 3 | 同じ |
| バッチ数/エポック | 約125 | 約1,635 | **13倍** |

**計算式**:
- 以前: 996 ÷ 8 = 125バッチ/エポック
- 現在: 3,270 ÷ 2 = 1,635バッチ/エポック

## 🔍 実行時間の内訳（推定）

### GPU使用時（CUDA / MPS）

1. **データ読み込み・前処理**: 1-2分
2. **モデル読み込み**: 30秒-1分
3. **エポック1**: 10-15分
4. **エポック2**: 10-15分
5. **エポック3**: 10-15分
6. **モデル保存**: 10-30秒

**合計**: 30-50分（GPU性能により変動）

### CPU使用時

1. **データ読み込み・前処理**: 1-2分
2. **モデル読み込み**: 30秒-1分
3. **エポック1**: 30-60分
4. **エポック2**: 30-60分
5. **エポック3**: 30-60分
6. **モデル保存**: 10-30秒

**合計**: 1.5-3時間

## 💡 実行時間を短縮する方法

### 1. バッチサイズを増やす

```python
BATCH_SIZE = 4  # 2 → 4に変更
```

**効果**: 実行時間が約半分に（メモリ使用量は2倍）

### 2. エポック数を減らす

```python
NUM_EPOCHS = 2  # 3 → 2に変更
```

**効果**: 実行時間が約2/3に（性能は若干低下する可能性）

### 3. データ数を減らす（検証用）

学習データの一部のみを使用してテスト実行

### 4. 混合精度学習（AMP）の活用

```python
USE_AMP = True  # 既に有効
```

**効果**: GPU使用時、約1.5-2倍高速化

## ⚠️ 注意事項

### 1. メモリ使用量

- **バッチサイズ2**: 約4-6GB VRAM
- **バッチサイズ4**: 約8-12GB VRAM
- **バッチサイズ8**: 約16-24GB VRAM

### 2. 実行中の監視

```bash
# GPU使用率の確認（Windows）
nvidia-smi

# GPU使用率の確認（Mac）
# Activity Monitor で GPU タブを確認
```

### 3. 中断と再開

学習中に中断した場合、スクリプトは最初から再実行する必要があります。
チェックポイント機能は現在実装されていません。

## 📝 推奨事項

1. **初回実行**: バッチサイズ2のまま実行して、メモリ使用量を確認
2. **メモリに余裕がある場合**: バッチサイズを4に増やす
3. **時間短縮が必要**: エポック数を2に減らす（性能は確認が必要）
4. **GPU必須**: CPUのみでの実行は非推奨（時間がかかりすぎる）

## 🎯 実用的な目安

- **最短**: 15-25分（RTX 4090 / M4 Max）
- **標準**: 30-45分（RTX 3060-3080 / M4標準）
- **最長**: 1.5-3時間（CPUのみ）

**推奨**: GPU環境で実行し、30-60分程度を見込む
