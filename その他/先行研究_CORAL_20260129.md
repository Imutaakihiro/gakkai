# 先行研究調査: CORAL（順序回帰）

**調査日**: 2026年1月29日  
**調査目的**: 順序回帰実験の再開に伴う、CORAL論文の特定と引用情報の整理

---

## 1. 研究概要

- **調査テーマ**: 順序回帰（ordinal regression）における CORAL（COnsistent RAnk Logits）枠組み
- **調査範囲**: 論文1本（Pattern Recognition Letters 2020）、公式PDF・実装リポジトリ

---

## 2. 主要な先行研究（CORAL）

### 基本情報

| 項目 | 内容 |
|------|------|
| **著者** | Wenzhi Cao, Vahid Mirjalili, Sebastian Raschka |
| **タイトル** | Rank consistent ordinal regression for neural networks with application to age estimation |
| **掲載誌** | Pattern Recognition Letters |
| **巻・頁** | Vol. 140, pp. 325–331 (2020) |
| **DOI** | https://doi.org/10.1016/j.patrec.2020.11.008 |
| **公開日** | 2020年11月6日（Online） |

### 研究の目的と手法

- **目的**: 順序ラベルを持つ予測タスクで、複数の二値分類に分解する既存手法が「ランクの一貫性」を保証しない問題を解消する。
- **手法**: **CORAL** — K段階の順序を K−1 個の二値タスクに拡張し、**最終層の重みを共有・バイアスのみタスク別**にすることで、理論的に **ランク単調性**（確率の大小が順序と整合）と**一貫した信頼度**を保証。学習は重み共有により複雑さを増やさない。
- **応用**: 顔画像からの年齢推定（MORPH-2, AFAD, CACD）、ResNet-34 ベースの CORAL-CNN。

### 主要な結果・知見

- OR-CNN（Niu et al.）と比べ、**予測誤差（MAE/RMSE）の有意な低減**。
- **定理1**: 損失（式(4)）を最小化する最適解で、バイアスが \( b_1 \geq b_2 \geq \cdots \geq b_{K-1} \) となり、確率が単調減少することを保証。
- 経験的にも、CORAL-CNN は不整合0件、OR-CNN は複数件の不整合が発生し、**不整合が予測性能を損なう**ことを示す。

### 本研究（授業評価・順序回帰）との関連性

- 授業評価スコアを **1〜4点の順序尺度** として扱い、P1〜P4 の確率を予測する順序回帰モデルを構築している点で、CORAL の枠組み（K−1 二値タスク・重み共有・バイアスでランク一貫性）と直接対応する。
- 卒論・関連研究では「順序回帰」の理論的根拠として引用するのに適している。

---

## 3. リンク・リソース

| 種類 | URL |
|------|-----|
| **論文PDF（公式）** | https://sebastianraschka.com/pdf/papers/2020-coral.pdf |
| **出版社（ScienceDirect）** | https://www.sciencedirect.com/science/article/pii/S0167865520301259 |
| **実装（CNN・論文付属）** | https://github.com/Raschka-research-group/coral-cnn |
| **実装（PyTorch 汎用・CORN含む）** | https://github.com/Raschka-research-group/coral-pytorch |
| **ドキュメント** | https://raschka-research-group.github.io/coral-pytorch/ |

---

## 4. 参考文献リスト（BibTeX）

```bibtex
@article{coral2020,
  author    = {Wenzhi Cao and Vahid Mirjalili and Sebastian Raschka},
  title     = {Rank consistent ordinal regression for neural networks with application to age estimation},
  journal   = {Pattern Recognition Letters},
  volume    = {140},
  pages     = {325--331},
  year      = {2020},
  publisher = {Elsevier},
  doi       = {10.1016/j.patrec.2020.11.008},
  url       = {https://doi.org/10.1016/j.patrec.2020.11.008}
}
```

### LaTeX（BibTeX キー `coral` で既存スタイルに合わせる場合）

卒論で以前使っていた形式に合わせる場合の例：

```bibtex
\bibitem{coral} Cao, W., Mirjalili, V., and Raschka, S.: ``Rank Consistent Ordinal Regression for Neural Networks with Application to Age Estimation,'' \textit{Pattern Recognition Letters}, Vol. 140, pp. 325--331 (2020).
```

---

## 5. メモ

- 卒論から順序回帰の記述を削除した際、参考文献からも coral を削除している（`削除文保管_20260128.txt`）。順序回帰を再掲する場合は、上記 BibTeX / 参考文献を再度追加する。
- 関連する先行研究: Li and Lin (2007) の general reduction、Niu et al. (2016) の OR-CNN。CORAL は OR-CNN の一貫性問題を理論的に解決したものとして位置づけられる。
